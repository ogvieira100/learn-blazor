@page "/taskslists"
@rendermode InteractiveAuto 

<TaskAddComponent Tasks=Tasks
TaskAdded=TaskUpdatedAsync />

<TasksListNotStartedComponent 
TasksUpdated=TaskUpdatedUpdateAllAsync
@ref="tasksListNotStartedComponent"
Tasks=Tasks />

<TasksListsInProgressComponent 
@ref="tasksListsInProgressComponent"
TasksUpdated=TaskUpdatedUpdateAllAsync
Tasks=Tasks />

<TasksListsCompletedComponent 
@ref="tasksListsCompletedComponent"
TasksUpdated=TaskUpdatedUpdateAllAsync
Tasks=Tasks />

@code {
    List<Tasks> Tasks { get; set; } 

    TasksListNotStartedComponent? tasksListNotStartedComponent { get; set; }

    TasksListsCompletedComponent? tasksListsCompletedComponent { get; set; }

    TasksListsInProgressComponent? tasksListsInProgressComponent { get; set; }

    async Task TaskUpdatedAsync(Models.TaskStatus taskStatus)
    {
        await Task.Run(() =>
        {

            switch (taskStatus)
            {
                case Models.TaskStatus.NotStarted:
                    tasksListNotStartedComponent?.UpdateComponent();
                    break;
                case Models.TaskStatus.InProgress:
                    tasksListsInProgressComponent?.UpdateComponent();
                    break;
                case Models.TaskStatus.Completed:
                    tasksListsCompletedComponent?.UpdateComponent();
                    break;
            }
            StateHasChanged();
        });

    }   

    async Task TaskUpdatedUpdateAllAsync(Models.TaskStatus taskStatus)
    {
        await Task.Run(() =>
        {
            tasksListNotStartedComponent?.UpdateComponent();
            tasksListsInProgressComponent?.UpdateComponent();
            tasksListsCompletedComponent?.UpdateComponent();
            StateHasChanged();
        });
    } 



    protected override void OnInitialized()
    {
        Tasks = new List<Tasks>();
        // Tasks = new List<Tasks>() { 
        
        //     new Tasks() 
        //     { Name = "Task 1", TaskStatus = BlazorApp.Client.Models.TaskStatus.NotStarted },
        //      new Tasks()
        //     { Name = "Task 1", TaskStatus = BlazorApp.Client.Models.TaskStatus.Completed },
        //      new Tasks()
        //     { Name = "Task 1", TaskStatus = BlazorApp.Client.Models.TaskStatus.InProgress }

        // };
    }

}
